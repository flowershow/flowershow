{"id":"flowershow-2lm","title":"Document public REST API with OpenAPI spec","description":"Generate an OpenAPI/Swagger specification for all public REST API endpoints under app/api/. This covers:\n\n**Endpoints to document:**\n- CLI Auth (device flow): POST /api/cli/device/authorize, POST /api/cli/device/token, POST /api/cli/authorize\n- Sites CRUD: POST /api/sites, GET /api/sites\n- Site sync: POST /api/sites/id/{siteId}/sync, POST /api/sites/id/{siteId}/files, DELETE /api/sites/id/{siteId}/files\n- Site status: GET /api/sites/id/{siteId}/status\n- Anonymous publish: POST /api/sites/publish-anon, POST /api/sites/claim\n- User: GET /api/user\n- Tokens: POST /api/tokens/revoke\n- Site auth: GET /api/sites/id/{siteId}/login, GET /api/sites/id/{siteId}/logout\n- Domain verification: GET /api/domain/{domain}/verify\n- Webhooks: POST /api/webhooks/github-app, POST /api/webhook, POST /api/stripe/webhook\n- GitHub App: GET /api/github-app/installations, GET /api/github-app/installations/{id}, GET /api/github-app/installation-url, POST /api/github-app/sync-repositories\n- Sitemap/robots: GET /api/sitemap/{user}/{project}, GET /api/robots/{hostname}\n\n**Deliverables:**\n1. An OpenAPI 3.1 spec file (e.g., docs/openapi.yaml) documenting all REST endpoints\n2. Each endpoint should include: method, path, description, auth requirements, request body schema, response schemas, error codes\n3. Spec should be validated with an OpenAPI linter\n\n**Approach:**\n- Read each route handler in app/api/ to extract request/response types\n- Use Zod schemas or TypeScript types where they exist to derive JSON Schema\n- Document authentication methods (Bearer token, session cookie, API key)","status":"closed","priority":2,"issue_type":"task","owner":"52197250+olayway@users.noreply.github.com","created_at":"2026-02-12T23:23:15.787454+01:00","created_by":"Ola Rubaj","updated_at":"2026-02-12T23:55:46.778303+01:00","closed_at":"2026-02-12T23:55:46.778303+01:00","close_reason":"Closed"}
{"id":"flowershow-3jo","title":"[Image v2] Build forward-link graph for page-scoped embed resolution","description":"Create a forward-link/index layer (including image embeds) so page rendering can fetch only referenced targets instead of scanning all site blobs. Out of scope for current v1 rollout; defer implementation until after v1 metrics and stabilization.","acceptance_criteria":"Epic tracks schema, extraction pipeline, query API, and migration/rollout plan for forward links; no implementation work is started under this epic in current session.","status":"open","priority":2,"issue_type":"epic","owner":"52197250+olayway@users.noreply.github.com","created_at":"2026-02-13T12:01:48.054692+01:00","created_by":"Ola Rubaj","updated_at":"2026-02-13T12:01:48.054692+01:00"}
{"id":"flowershow-6bk","title":"Create script to reindex site content in Typesense from R2","description":"Sites created via CLI or Obsidian plugin may not have had their content indexed in Typesense (related to flowershow-8af). Need a script that:\n1. Takes a site ID as input\n2. Reads all markdown files from R2 for that site\n3. Ensures the Typesense collection exists\n4. Parses frontmatter (title, description, authors, date) and content\n5. Upserts each document into Typesense\n6. Supports dry-run mode and multiple site IDs\n\nThis is a manual remediation tool for sites that were created before the ensureSiteCollection fix was deployed.","status":"closed","priority":1,"issue_type":"task","owner":"52197250+olayway@users.noreply.github.com","created_at":"2026-02-12T20:54:32.992155+01:00","created_by":"Ola Rubaj","updated_at":"2026-02-12T22:15:02.482231+01:00","closed_at":"2026-02-12T22:15:02.482231+01:00","close_reason":"Closed"}
{"id":"flowershow-8af","title":"Typesense collection not created for CLI/Obsidian/anon publish paths","description":"Sites created or published via CLI, Obsidian plugin, or anonymous publish endpoints use API routes directly (POST /api/sites, POST /api/sites/id/:siteId/files, POST /api/sites/id/:siteId/sync, POST /api/sites/publish-anon) instead of the Inngest syncSite function. The Inngest path creates the Typesense collection before uploading files (inngest/functions.ts:99-104), but none of the API endpoints do. When the Cloudflare worker processes these uploads and tries to upsert documents into Typesense, the collection doesn't exist. The worker silently swallows the error (worker.js indexInTypesense catch block) and marks the blob as SUCCESS anyway, so search never works for these sites.\n\nFix: Add createSiteCollection() calls to all 4 API endpoints that create or publish sites without going through Inngest.","status":"closed","priority":1,"issue_type":"bug","owner":"52197250+olayway@users.noreply.github.com","created_at":"2026-02-12T19:15:42.179579+01:00","created_by":"Ola Rubaj","updated_at":"2026-02-12T19:37:03.385626+01:00","closed_at":"2026-02-12T19:37:03.385626+01:00","close_reason":"Closed"}
{"id":"flowershow-bma","title":"Address 34 Dependabot security vulnerabilities","description":"GitHub reports 34 vulnerabilities on the default branch:\n- 18 high severity\n- 12 moderate severity\n- 4 low severity\n\nSee: https://github.com/flowershow/flowershow/security/dependabot\n\nNeed to review and update affected dependencies. Some may require major version bumps or replacement packages.","status":"closed","priority":2,"issue_type":"task","owner":"52197250+olayway@users.noreply.github.com","created_at":"2026-02-12T22:17:42.711104+01:00","created_by":"Ola Rubaj","updated_at":"2026-02-12T22:35:11.541621+01:00","closed_at":"2026-02-12T22:35:11.541621+01:00","close_reason":"Closed"}
{"id":"flowershow-fp3","title":"support umami as analytics with config item for it","status":"open","priority":2,"issue_type":"feature","owner":"rufus@lifeitself.org","created_at":"2026-02-15T01:36:51.306455+01:00","created_by":"Rufus Pollock","updated_at":"2026-02-15T01:36:51.306455+01:00"}
{"id":"flowershow-gt1","title":"if no nav in config.json don't show it","status":"closed","priority":2,"issue_type":"feature","owner":"rufus@lifeitself.org","created_at":"2026-02-15T01:37:44.083326+01:00","created_by":"Rufus Pollock","updated_at":"2026-02-15T01:38:05.047597+01:00","closed_at":"2026-02-15T01:38:05.047597+01:00","close_reason":"Closed"}
{"id":"flowershow-k2l","title":"support for nested nav","status":"open","priority":2,"issue_type":"feature","owner":"rufus@lifeitself.org","created_at":"2026-02-15T01:37:19.438753+01:00","created_by":"Rufus Pollock","updated_at":"2026-02-15T01:37:19.438753+01:00"}
{"id":"flowershow-kpm","title":"Image optimization v1 rollout (from RFC #984)","description":"Follow-up implementation track for RFC #984. Scope: markdown images via next/image, explicit sizes for responsive/fill usages, and measured impact. Out of scope: Cloudflare custom loader/v2 infra work.","acceptance_criteria":"Content images render via next/image; responsive/fill images have explicit sizes; before/after metrics are documented; edge cases are validated or deferred with follow-up issues.","status":"in_progress","priority":2,"issue_type":"epic","owner":"52197250+olayway@users.noreply.github.com","created_at":"2026-02-13T00:53:10.720473+01:00","created_by":"Ola Rubaj","updated_at":"2026-02-13T01:06:17.533196+01:00"}
{"id":"flowershow-kpm.1","title":"[Image v1] Audit image rendering paths and baseline metrics","description":"Identify markdown/content image rendering paths, find responsive/fill next/image usages missing sizes, and record baseline LCP + image transfer bytes on representative pages.","acceptance_criteria":"Audit note posted with file/route coverage; baseline metrics table recorded; validation pages/components listed.","notes":"## AUDIT FINDINGS - Image Rendering Paths\n\n### Summary\n\n**Current state**: Markdown content images are NOT optimized (plain `\u003cimg\u003e`). Layout/component images ARE optimized via `next/image`.\n\n### 1. Markdown/Content Image Rendering Path\n\n**Pipeline** (`lib/markdown.ts`):\n1. Remark plugins process markdown → AST\n2. `remarkObsidianImageSize` extracts width/height from Obsidian alt-text syntax\n3. `rehypeResolveHtmlUrls` resolves relative paths to absolute URLs\n4. `rehypeUnwrapParagraphsAroundMedia` removes `\u003cp\u003e` wrappers around images\n5. Final output: **plain HTML `\u003cimg\u003e` tags** (NOT next/image)\n\n**Key files**:\n- `lib/markdown.ts` - MDX processing config\n- `lib/remark-obsidian-image-size.ts` - Obsidian image sizing\n- `lib/rehype-resolve-html-urls.ts` - URL resolution\n- `components/public/mdx/fs-image.tsx` - Image wrapper (optimization DISABLED per #1013)\n- `components/public/mdx/mdx-components-factory.tsx` - `img` component is COMMENTED OUT\n\n**Why disabled**: Issue #1013 - bugs with private sites, HTML+Tailwind, Obsidian sizing. Reverted pending RFC #984.\n\n### 2. next/image Usages (All properly configured)\n\n| File | Props | Status |\n|------|-------|--------|\n| `components/public/hero.tsx:89-96` | width=1200, height=800, fetchPriority=\"high\" | ✅ |\n| `components/public/nav.tsx:65-71` | width=32, height=32 | ✅ |\n| `components/public/layouts/blog.tsx:104-113` | fill=true, sizes=\"(min-width: 1280px) 1152px, 100vw\" | ✅ |\n| `components/public/mdx/list.tsx:142-151` | width=1200, height=800 | ✅ |\n| `components/public/mdx/obsidian-base-cards.tsx:268-277` | fill=true, sizes=\"${cardSize}px\" | ✅ |\n| `components/dashboard/blur-image.tsx` | Forwards all props | ⚠️ Caller dependent |\n| `components/dashboard/nav.tsx:84` | width=32, height=32 | ✅ |\n| `components/dashboard/profile.tsx:14-23` | width=40, height=40 | ✅ |\n| `app/(cloud)/login/page.tsx:17-23` | width=48, height=48 | ✅ |\n\n### 3. Configuration\n\n`next.config.mjs`:\n```js\nimages: { remotePatterns: [{ hostname: '*' }] }\n```\n- Allows images from any domain\n- No custom loader (uses Vercel default)\n\n### 4. Key Issues\n\n1. **Markdown images bypass optimization** - FsImage returns `\u003cimg\u003e`, not `\u003cImage\u003e`\n2. **No srcset/sizes on content images** - Original file always downloaded\n3. **Image geometry unknown at render time** - See issue #978\n\n### 5. Related Issues/PRs\n\n- **RFC #984**: Image optimization plan (open PR with `rfcs/image-optimization.md`)\n- **Issue #978**: Store image geometry at upload time (OPEN)\n- **Issue #1013**: Disable optimization until edge cases handled (CLOSED - optimization reverted)\n\n### 6. Validation Pages for Metrics\n\nRepresentative pages to test:\n- Any markdown page with embedded images\n- Blog post pages with featured images\n- Obsidian Bases views with card images\n- Custom landing pages with HTML images\n\n### 7. Baseline Metrics\n\n**Cannot measure LCP/transfer bytes without running the site.** Recommend:\n1. Run dev server and use Chrome DevTools Lighthouse\n2. Or use production URL with PageSpeed Insights\n\n**Expected baseline issues**:\n- Content images: No srcset, full-size downloads regardless of viewport\n- LCP likely degraded on image-heavy pages","status":"closed","priority":2,"issue_type":"task","owner":"52197250+olayway@users.noreply.github.com","created_at":"2026-02-13T00:53:11.160007+01:00","created_by":"Ola Rubaj","updated_at":"2026-02-15T01:02:47.671298+01:00","closed_at":"2026-02-13T02:33:30.486895+01:00","dependencies":[{"issue_id":"flowershow-kpm.1","depends_on_id":"flowershow-kpm","type":"parent-child","created_at":"2026-02-13T00:53:11.169344+01:00","created_by":"Ola Rubaj"}]}
{"id":"flowershow-kpm.2","title":"[Image v1] Render markdown content images via next/image","description":"Replace markdown pipeline plain img rendering with next/image while preserving authoring behavior and URL resolution.","acceptance_criteria":"Markdown images use next/image; no functional rendering regressions; known limitations documented.","status":"in_progress","priority":2,"issue_type":"feature","owner":"52197250+olayway@users.noreply.github.com","created_at":"2026-02-13T00:53:11.502861+01:00","created_by":"Ola Rubaj","updated_at":"2026-02-15T01:02:47.671826+01:00","dependencies":[{"issue_id":"flowershow-kpm.2","depends_on_id":"flowershow-kpm","type":"parent-child","created_at":"2026-02-13T00:53:11.504795+01:00","created_by":"Ola Rubaj"}]}
{"id":"flowershow-kpm.3","title":"[Image v1] Add explicit sizes to responsive/fill image usages","description":"Add explicit sizes values for responsive/fill next/image usages and standardize defaults by context (content vs hero/featured/etc.).","acceptance_criteria":"No responsive/fill image relies on implicit sizing defaults; chosen sizes are documented and consistent.","status":"open","priority":2,"issue_type":"task","owner":"52197250+olayway@users.noreply.github.com","created_at":"2026-02-13T00:53:11.855138+01:00","created_by":"Ola Rubaj","updated_at":"2026-02-13T00:53:11.855138+01:00","dependencies":[{"issue_id":"flowershow-kpm.3","depends_on_id":"flowershow-kpm","type":"parent-child","created_at":"2026-02-13T00:53:11.85823+01:00","created_by":"Ola Rubaj"}]}
{"id":"flowershow-kpm.4","title":"[Image v1] Validate edge cases and prevent regressions","description":"Validate vertical/tall images, remote/protected images, redirects, broken/missing images, and layout stability risks.","acceptance_criteria":"Edge cases are verified in preview; non-v1 fixes are tracked as follow-up issues.","status":"open","priority":2,"issue_type":"task","owner":"52197250+olayway@users.noreply.github.com","created_at":"2026-02-13T00:53:12.224454+01:00","created_by":"Ola Rubaj","updated_at":"2026-02-13T00:53:12.224454+01:00","dependencies":[{"issue_id":"flowershow-kpm.4","depends_on_id":"flowershow-kpm","type":"parent-child","created_at":"2026-02-13T00:53:12.227363+01:00","created_by":"Ola Rubaj"}]}
{"id":"flowershow-kpm.5","title":"[Image v1] Measure impact and document rollout decision","description":"Capture post-change metrics on same representative pages, compare against baseline, and recommend whether to stop at v1 or open v2.","acceptance_criteria":"Before/after comparison is documented on parent issue; clear recommendation captured.","status":"open","priority":2,"issue_type":"task","owner":"52197250+olayway@users.noreply.github.com","created_at":"2026-02-13T00:53:12.599734+01:00","created_by":"Ola Rubaj","updated_at":"2026-02-13T00:53:12.599734+01:00","dependencies":[{"issue_id":"flowershow-kpm.5","depends_on_id":"flowershow-kpm","type":"parent-child","created_at":"2026-02-13T00:53:12.602038+01:00","created_by":"Ola Rubaj"}]}
{"id":"flowershow-m7m","title":"Create comprehensive ARCHITECTURE.md for AI agent context","description":"Create a comprehensive ARCHITECTURE.md that serves as context for AI agents working on the codebase. Should cover: the main Flowershow Next.js app, CLI tool, Cloudflare Worker, and Obsidian plugin. Include data flows for publishing sites and files, API structure, database schema overview, and key integration points between components.","status":"closed","priority":2,"issue_type":"task","owner":"52197250+olayway@users.noreply.github.com","created_at":"2026-02-12T18:58:45.355615+01:00","created_by":"Ola Rubaj","updated_at":"2026-02-12T20:22:10.551882+01:00","closed_at":"2026-02-12T20:22:10.551882+01:00","close_reason":"Closed"}
{"id":"flowershow-usr","title":"Create comprehensive architecture summary (ARCHITECTURE.md) for AI agents","description":"Create a detailed ARCHITECTURE.md that documents the full Flowershow platform architecture for AI agent context. Covers the Next.js web app, CLI, Cloudflare worker, Obsidian plugin, data model, auth flows, and content publishing pipelines.","status":"closed","priority":1,"issue_type":"task","owner":"52197250+olayway@users.noreply.github.com","created_at":"2026-02-12T20:15:36.774022+01:00","created_by":"Ola Rubaj","updated_at":"2026-02-12T20:18:44.487012+01:00","closed_at":"2026-02-12T20:18:44.487012+01:00","close_reason":"Closed"}
{"id":"flowershow-zgf","title":"gray-matter breaks with js-yaml 4 override","description":"After upgrading js-yaml to \u003e=4.1.1 via pnpm overrides (vulnerability fix), gray-matter@4.0.3 breaks at runtime with: 'Function yaml.safeLoad is removed in js-yaml 4. Use yaml.load instead, which is now safe by default.' gray-matter calls yaml.safeLoad/yaml.safeDump which were removed in js-yaml 4. Fix: added pnpm patch for gray-matter that uses yaml.load/yaml.dump with fallback. gray-matter is unmaintained (last release 2019).","status":"closed","priority":2,"issue_type":"bug","owner":"52197250+olayway@users.noreply.github.com","created_at":"2026-02-13T01:33:32.442233+01:00","created_by":"Ola Rubaj","updated_at":"2026-02-13T01:34:07.619058+01:00","closed_at":"2026-02-13T01:34:07.619058+01:00","close_reason":"Closed"}
